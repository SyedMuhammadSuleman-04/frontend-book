# Data Model: Digital Twin Simulation for Humanoid Robots

**Feature**: 002-digital-twin-sim
**Created**: 2025-12-20
**Status**: Draft

## Key Entities

### Simulation Environment
**Description**: A virtual space containing physics properties, objects, lighting, and environmental conditions that affect robot behavior and sensor readings

**Properties**:
- `id` (string): Unique identifier for the environment
- `name` (string): Display name for the environment
- `physics_parameters` (object):
  - `gravity` (vector3): Gravity vector (x, y, z)
  - `friction_coefficient` (float): Default friction coefficient
  - `collision_tolerance` (float): Collision detection tolerance
- `objects` (array): List of objects in the environment
- `lighting` (object):
  - `ambient_light` (float): Ambient light intensity
  - `directional_light` (object): Directional light properties
- `terrain` (object): Terrain properties and heightmap
- `created_at` (datetime): Timestamp of environment creation
- `updated_at` (datetime): Timestamp of last modification

**Relationships**:
- Contains multiple Robot Models
- Uses Physics Engine for simulation

**Validation Rules**:
- Gravity values must be within realistic ranges (-20 to 20 m/s²)
- Friction coefficient must be between 0 and 10
- Object list must not exceed performance limits
- Name must be unique within the system

### Robot Model
**Description**: A representation of the physical robot including kinematic structure, physical properties, and sensor configurations that interact with the simulation environment

**Properties**:
- `id` (string): Unique identifier for the robot model
- `name` (string): Display name for the robot
- `kinematic_structure` (object): URDF/SDF representation
- `physical_properties` (object):
  - `mass` (float): Total mass of the robot
  - `inertial_tensor` (object): Inertial tensor properties
  - `center_of_mass` (vector3): Center of mass coordinates
- `sensor_configurations` (array): List of sensor configurations
- `joint_limits` (object): Joint angle and velocity limits
- `actuator_properties` (object): Properties of robot actuators
- `created_at` (datetime): Timestamp of model creation
- `updated_at` (datetime): Timestamp of last modification

**Relationships**:
- Interacts with Simulation Environment
- Produces Sensor Data
- Belongs to a specific Simulation Session

**Validation Rules**:
- URDF/SDF must be valid and parseable
- Mass must be positive
- Joint limits must be within safe ranges
- Sensor configurations must reference valid sensor types

### Sensor Data
**Description**: Simulated measurements from various sensors (LiDAR, cameras, IMUs) that mimic real-world sensor outputs for robot perception and control

**Properties**:
- `id` (string): Unique identifier for the sensor data record
- `sensor_id` (string): Reference to the sensor that produced this data
- `data_type` (string): Type of sensor data (lidar, camera, imu, etc.)
- `timestamp` (datetime): Time when data was captured
- `data_payload` (object): Actual sensor data in appropriate format:
  - For LiDAR: sensor_msgs/LaserScan format
  - For Camera: sensor_msgs/Image format
  - For IMU: sensor_msgs/Imu format
- `frame_id` (string): Coordinate frame of the sensor
- `noise_characteristics` (object): Noise model parameters
- `quality_metrics` (object): Data quality indicators

**Relationships**:
- Generated by Robot Model
- Consumed by Perception Systems
- Associated with Simulation Environment

**Validation Rules**:
- Data format must match expected sensor message types
- Timestamp must be within simulation time bounds
- Frame ID must reference valid coordinate frames
- Data values must be within expected ranges for sensor type

## State Transitions

### Simulation Environment States
- `created` → `configured` → `running` → `paused` → `stopped` → `archived`
- Transitions must maintain data consistency across states

### Robot Model States
- `defined` → `loaded` → `calibrated` → `active` → `inactive` → `unloaded`
- Each state has specific validation requirements

### Sensor Data States
- `generated` → `processed` → `validated` → `archived`
- Data quality validation occurs during processing

## Relationships

```
Simulation Environment (1) ←→ (Many) Robot Model
Robot Model (1) ←→ (Many) Sensor Data
Simulation Environment (1) ←→ (Many) Sensor Data
```

## Indexes

- Simulation Environment: Index on name for fast lookup
- Robot Model: Index on name and kinematic_structure hash
- Sensor Data: Index on timestamp and sensor_id for time-series queries